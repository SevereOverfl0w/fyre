#!/bin/sh
#
# wildefyr & z3bra - 2016 (c) MIT
# fullscreen without borders, remembers previous window geometry

ARGS="$@"

usage() {
    cat >&2 << EOF
Usage: $(basename $0) <wid>
EOF

    test $# -eq 0 || exit $1
}

main() {
    . fyrerc

    wattr "$1" && wid="$1" || wid=$PFW

    test -f "$FSFILE" && {
        test "$PFW" = "$wid" && {
            setborder active "$wid"
            wtp $(cat "$FSFILE")
            rm "$FSFILE"
        }
        test "$PFW" != "$wid" && {
            setborder active "$wid"
            setborder inactive "$PFW"
            wtp $(cat "$FSFILE")
            rm "$FSFILE"
            $(basename $0) "$wid"
        }
        exit
    }

    setborder none "$wid"
    wattr xywhi "$wid" > "$FSFILE"
    wtp 0 0 $SW $SH "$wid"
}

for arg in $ARGS; do
    case "$arg" in
        -q|--quiet)       QUIETFLAG=true ;;
        h|help|-h|--help) usage 0        ;;
    esac
done

test "$QUIETFLAG" = "true" && {
    main $ARGS 2>&1 > /dev/null
} || {
    main $ARGS
}
