#!/bin/mksh
#
# File        : /home/wildefyr/fyre/detection
# Maintainer  : Wildefyr | http://wildefyr.net
# Copyright   : Wildefyr | Licensed under the WTFPL license.
# Description : Find special windows and add them to an ignore list.

# I recommend if you want to have these windows in any other position or even
# added to a new group, put it under where it checks it's wid.

source fyrerc

for wid in $(lsw); do

    windowC=$(wclass c $wid)
    windowP=$(wclass p $wid)

    if [[ $windowC == "vdpau" ]]; then
        mpvWid=$wid
    elif [[ $windowC == "xv" ]]; then
        mpvWid=$wid
    elif [[ $windowC == "gl" ]]; then
        mpvWid=$wid
    fi

    if [[ $windowP == *"firefox"* ]]; then
        printf '%s\n' $wid >> $DETECT
        firefoxCounter=1
        firefoxWid=$wid
        if [ ! -e $GROUPSDIR/group.2 ]; then
            wgroups -s $wid 2
        fi
    fi

    if [[ $windowC == "mupdf" ]]; then
        printf '%s\n' $wid >> $DETECT
        mupdfCounter=1
        mupdfWid=$wid

        if [ ! -e $GROUPSDIR/group.2 ]; then
            wgroups -s $wid 1
        fi
    fi

    if [[ $windowC == "Steam" ]]; then
        printf '%s\n' $wid >> $DETECT
        steamCounter=$((steamCounter + 1))
        steamWid=$wid
    fi

    if [[ $windowC == "urxvt" ]]; then
        printf '%s\n' $wid >> $DETECT
        urxvtCounter=1
        urxvtWid=$wid
    fi

done

totalDetectList=$((detectionCounter + firefoxCounter + steamCounter + \
                   urxvtCounter + mupdfCounter))
windowsOnscreen=$((windowsOnscreen - totalDetectList))
